{"version":3,"file":"mat2.js","sources":["../../../../src/math/algebra/mat2.ts"],"sourcesContent":["import { Pool } from \"../pool.js\";\r\nimport { Vec2 } from \"./vec2.js\";\r\n\r\nexport class Mat2Pool extends Pool<Mat2>{\r\n    constructObject() { return new Mat2; }\r\n}\r\nexport const mat2Pool = new Mat2Pool;\r\nexport class Mat2 {\r\n    elem: number[];\r\n    static id = new Mat2(1, 0, 0, 1);\r\n    static zero = new Mat2(0, 0, 0, 0);\r\n    static diag(a: number, b: number): Mat2 {\r\n        return new Mat2(\r\n            a, 0,\r\n            0, b\r\n        );\r\n    }\r\n    constructor(\r\n        a: number = 1, b: number = 0,\r\n        c: number = 0, d: number = 1\r\n    ) { this.elem = [a, b, c, d]; }\r\n    set(\r\n        a: number = 0, b: number = 0,\r\n        c: number = 0, d: number = 0\r\n    ): Mat2 { this.elem[0] = a; this.elem[1] = b; this.elem[2] = c; this.elem[3] = d; return this; }\r\n    setid() { this.elem[0] = 1; this.elem[1] = 0; this.elem[2] = 0; this.elem[3] = 1; return this; }\r\n    ts(): Mat2 {\r\n        let tmp = this.elem[1]; this.elem[1] = this.elem[2]; this.elem[2] = tmp;\r\n        return this;\r\n    }\r\n    t(): Mat2 {\r\n        return new Mat2(\r\n            this.elem[0], this.elem[2],\r\n            this.elem[1], this.elem[3]\r\n        );\r\n    }\r\n    copy(m2: Mat2): Mat2 {\r\n        for (var i = 0; i < 4; i++) {\r\n            this.elem[i] = m2.elem[i];\r\n        }\r\n        return this;\r\n    }\r\n    add(m2: Mat2): Mat2 {\r\n        let m = new Mat2();\r\n        for (var i = 0; i < 4; i++) {\r\n            m.elem[i] = this.elem[i] + m2.elem[i];\r\n        }\r\n        return m;\r\n    }\r\n    adds(m2: Mat2): Mat2 {\r\n        for (var i = 0; i < 4; i++) {\r\n            this.elem[i] += m2.elem[i];\r\n        }\r\n        return this;\r\n    }\r\n    neg(): Mat2 {\r\n        let m = new Mat2();\r\n        for (var i = 0; i < 4; i++) {\r\n            m.elem[i] = -this.elem[i];\r\n        }\r\n        return m;\r\n    }\r\n    negs(): Mat2 {\r\n        for (var i = 0; i < 4; i++) {\r\n            this.elem[i] = -this.elem[i];\r\n        }\r\n        return this;\r\n    }\r\n    sub(m2: Mat2): Mat2 {\r\n        let m = new Mat2();\r\n        for (var i = 0; i < 4; i++) {\r\n            m.elem[i] = this.elem[i] - m2.elem[i];\r\n        }\r\n        return m;\r\n    }\r\n    subs(m2: Mat2): Mat2 {\r\n        for (var i = 0; i < 4; i++) {\r\n            this.elem[i] -= m2.elem[i];\r\n        }\r\n        return this;\r\n    }\r\n    mulf(k: number): Mat2 {\r\n        let m = new Mat2();\r\n        for (var i = 0; i < 4; i++) {\r\n            m.elem[i] = this.elem[i] * k;\r\n        }\r\n        return m;\r\n    }\r\n    mulfs(k: number): Mat2 {\r\n        for (var i = 0; i < 4; i++) {\r\n            this.elem[i] *= k;\r\n        }\r\n        return this;\r\n    }\r\n    mulv(v: Vec2): Vec2 {\r\n        let a = this.elem;\r\n        return new Vec2(\r\n            v.x * a[0] + v.y * a[1],\r\n            v.x * a[2] + v.y * a[3]\r\n        );\r\n    }\r\n    mul(m: Mat2): Mat2 {\r\n        let a = this.elem; let b = m.elem;\r\n        return new Mat2(\r\n            a[0] * b[0] + a[1] * b[2], a[0] * b[1] + a[1] * b[3],\r\n            a[2] * b[0] + a[3] * b[2], a[2] * b[1] + a[3] * b[3]\r\n        );\r\n    }\r\n    muls(m: Mat2): Mat2 {\r\n        let a = this.elem; let b = m.elem;\r\n        this.set(\r\n            a[0] * b[0] + a[1] * b[2], a[0] * b[1] + a[1] * b[3],\r\n            a[2] * b[0] + a[3] * b[2], a[2] * b[1] + a[3] * b[3]\r\n        );\r\n        return this;\r\n    }\r\n    inv(): Mat2 {\r\n        let me = this.elem;\r\n        let a = me[0], b = me[1], c = me[2], d = me[3],\r\n            det = a * d - b * c;\r\n        if (det === 0) {\r\n            console.warn(\"Matrix determinant is 0\");\r\n            return new Mat2(0, 0, 0, 0);\r\n        }\r\n        let detInv = 1 / det;\r\n        return new Mat2(\r\n            d * detInv,\r\n            -b * detInv,\r\n            -c * detInv,\r\n            a * detInv\r\n        );\r\n    }\r\n    invs(): Mat2 {\r\n        let me = this.elem;\r\n        let a = me[0], b = me[1], c = me[2], d = me[3],\r\n            det = a * d - b * c;\r\n        if (det === 0) {\r\n            var msg = \"Matrix determinant is 0\";\r\n            console.warn(msg);\r\n            me.fill(0);\r\n            return this;\r\n        }\r\n        let detInv = 1 / det;\r\n        me[0] = d * detInv;\r\n        me[1] = -b * detInv;\r\n        me[2] = -c * detInv;\r\n        me[3] = a * detInv;\r\n        return this;\r\n    }\r\n    pushPool(pool: Mat2Pool = mat2Pool) {\r\n        pool.push(this);\r\n    }\r\n}\r\nexport let _mat2 = new Mat2();\r\n"],"names":[],"mappings":";;;AAGM,MAAO,QAAS,SAAQ,IAAU,CAAA;AACpC,IAAA,eAAe,KAAK,OAAO,IAAI,IAAI,CAAC,CAAC;AACxC;AACM,MAAM,QAAQ,GAAG,IAAI;MACf,IAAI,CAAA;AACb,IAAA,IAAI;AACJ,IAAA,OAAO,EAAE,GAAG,IAAI,IAAI,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;AAChC,IAAA,OAAO,IAAI,GAAG,IAAI,IAAI,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;AAClC,IAAA,OAAO,IAAI,CAAC,CAAS,EAAE,CAAS,EAAA;QAC5B,OAAO,IAAI,IAAI,CACX,CAAC,EAAE,CAAC,EACJ,CAAC,EAAE,CAAC,CACP;IACL;IACA,WAAA,CACI,CAAA,GAAY,CAAC,EAAE,CAAA,GAAY,CAAC,EAC5B,CAAA,GAAY,CAAC,EAAE,CAAA,GAAY,CAAC,EAAA,EAC5B,IAAI,CAAC,IAAI,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;IAC9B,GAAG,CACC,CAAA,GAAY,CAAC,EAAE,CAAA,GAAY,CAAC,EAC5B,CAAA,GAAY,CAAC,EAAE,CAAA,GAAY,CAAC,EAAA,EACtB,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,OAAO,IAAI,CAAC,CAAC;IAC/F,KAAK,GAAA,EAAK,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,OAAO,IAAI,CAAC,CAAC;IAC/F,EAAE,GAAA;QACE,IAAI,GAAG,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;AAAE,QAAA,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;AAAE,QAAA,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,GAAG,GAAG;AACvE,QAAA,OAAO,IAAI;IACf;IACA,CAAC,GAAA;AACG,QAAA,OAAO,IAAI,IAAI,CACX,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,EAC1B,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAC7B;IACL;AACA,IAAA,IAAI,CAAC,EAAQ,EAAA;AACT,QAAA,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE;AACxB,YAAA,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,CAAC,CAAC;QAC7B;AACA,QAAA,OAAO,IAAI;IACf;AACA,IAAA,GAAG,CAAC,EAAQ,EAAA;AACR,QAAA,IAAI,CAAC,GAAG,IAAI,IAAI,EAAE;AAClB,QAAA,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE;AACxB,YAAA,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,CAAC,CAAC;QACzC;AACA,QAAA,OAAO,CAAC;IACZ;AACA,IAAA,IAAI,CAAC,EAAQ,EAAA;AACT,QAAA,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE;AACxB,YAAA,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC,IAAI,CAAC,CAAC,CAAC;QAC9B;AACA,QAAA,OAAO,IAAI;IACf;IACA,GAAG,GAAA;AACC,QAAA,IAAI,CAAC,GAAG,IAAI,IAAI,EAAE;AAClB,QAAA,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE;AACxB,YAAA,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;QAC7B;AACA,QAAA,OAAO,CAAC;IACZ;IACA,IAAI,GAAA;AACA,QAAA,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE;AACxB,YAAA,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;QAChC;AACA,QAAA,OAAO,IAAI;IACf;AACA,IAAA,GAAG,CAAC,EAAQ,EAAA;AACR,QAAA,IAAI,CAAC,GAAG,IAAI,IAAI,EAAE;AAClB,QAAA,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE;AACxB,YAAA,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,CAAC,CAAC;QACzC;AACA,QAAA,OAAO,CAAC;IACZ;AACA,IAAA,IAAI,CAAC,EAAQ,EAAA;AACT,QAAA,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE;AACxB,YAAA,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC,IAAI,CAAC,CAAC,CAAC;QAC9B;AACA,QAAA,OAAO,IAAI;IACf;AACA,IAAA,IAAI,CAAC,CAAS,EAAA;AACV,QAAA,IAAI,CAAC,GAAG,IAAI,IAAI,EAAE;AAClB,QAAA,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE;AACxB,YAAA,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC;QAChC;AACA,QAAA,OAAO,CAAC;IACZ;AACA,IAAA,KAAK,CAAC,CAAS,EAAA;AACX,QAAA,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE;AACxB,YAAA,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC;QACrB;AACA,QAAA,OAAO,IAAI;IACf;AACA,IAAA,IAAI,CAAC,CAAO,EAAA;AACR,QAAA,IAAI,CAAC,GAAG,IAAI,CAAC,IAAI;AACjB,QAAA,OAAO,IAAI,IAAI,CACX,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,EACvB,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAC1B;IACL;AACA,IAAA,GAAG,CAAC,CAAO,EAAA;AACP,QAAA,IAAI,CAAC,GAAG,IAAI,CAAC,IAAI;AAAE,QAAA,IAAI,CAAC,GAAG,CAAC,CAAC,IAAI;AACjC,QAAA,OAAO,IAAI,IAAI,CACX,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,EACpD,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CACvD;IACL;AACA,IAAA,IAAI,CAAC,CAAO,EAAA;AACR,QAAA,IAAI,CAAC,GAAG,IAAI,CAAC,IAAI;AAAE,QAAA,IAAI,CAAC,GAAG,CAAC,CAAC,IAAI;AACjC,QAAA,IAAI,CAAC,GAAG,CACJ,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,EACpD,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CACvD;AACD,QAAA,OAAO,IAAI;IACf;IACA,GAAG,GAAA;AACC,QAAA,IAAI,EAAE,GAAG,IAAI,CAAC,IAAI;AAClB,QAAA,IAAI,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,EAC1C,GAAG,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC;AACvB,QAAA,IAAI,GAAG,KAAK,CAAC,EAAE;AACX,YAAA,OAAO,CAAC,IAAI,CAAC,yBAAyB,CAAC;YACvC,OAAO,IAAI,IAAI,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;QAC/B;AACA,QAAA,IAAI,MAAM,GAAG,CAAC,GAAG,GAAG;QACpB,OAAO,IAAI,IAAI,CACX,CAAC,GAAG,MAAM,EACV,CAAC,CAAC,GAAG,MAAM,EACX,CAAC,CAAC,GAAG,MAAM,EACX,CAAC,GAAG,MAAM,CACb;IACL;IACA,IAAI,GAAA;AACA,QAAA,IAAI,EAAE,GAAG,IAAI,CAAC,IAAI;AAClB,QAAA,IAAI,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,EAC1C,GAAG,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC;AACvB,QAAA,IAAI,GAAG,KAAK,CAAC,EAAE;YACX,IAAI,GAAG,GAAG,yBAAyB;AACnC,YAAA,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC;AACjB,YAAA,EAAE,CAAC,IAAI,CAAC,CAAC,CAAC;AACV,YAAA,OAAO,IAAI;QACf;AACA,QAAA,IAAI,MAAM,GAAG,CAAC,GAAG,GAAG;AACpB,QAAA,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,MAAM;QAClB,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,MAAM;QACnB,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,MAAM;AACnB,QAAA,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,MAAM;AAClB,QAAA,OAAO,IAAI;IACf;IACA,QAAQ,CAAC,OAAiB,QAAQ,EAAA;AAC9B,QAAA,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC;IACnB;;AAEG,IAAI,KAAK,GAAG,IAAI,IAAI;;;;"}