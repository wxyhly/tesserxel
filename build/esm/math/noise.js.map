{"version":3,"file":"noise.js","sources":["../../../src/math/noise.ts"],"sourcesContent":["import { Srand } from \"./random\";\r\n\r\nexport class Perlin3 {\r\n    private _p = new Uint8Array(512);\r\n    constructor(srand: Srand) {\r\n        const p = this._p;\r\n        for (let i = 0; i < 256; i++) {\r\n            p[i] = i;\r\n        }\r\n        let i = 255;\r\n        while (i--) {\r\n            let j = srand.nexti(i);\r\n            let x = p[i];\r\n            p[i] = p[j];\r\n            p[j] = x;\r\n        }\r\n        for (i = 0; i < 256; i++) {\r\n            p[i + 256] = p[i];\r\n        }\r\n    }\r\n    value(x: number, y: number, z: number) {\r\n        const p = this._p;\r\n        let X = Math.floor(x) & 255;\r\n        let Y = Math.floor(y) & 255;\r\n        let Z = Math.floor(z) & 255;\r\n        x -= Math.floor(x);\r\n        y -= Math.floor(y);\r\n        z -= Math.floor(z);\r\n        function _fade(t: number) {\r\n            return t * t * t * (t * (t * 6 - 15) + 10);\r\n        }\r\n        let u = _fade(x);\r\n        let v = _fade(y);\r\n        let w = _fade(z);\r\n\r\n        function _lerp(t: number, a: number, b: number) {\r\n            return a + t * (b - a);\r\n        }\r\n\r\n        function _grad(hash: number, x: number, y: number, z: number) {\r\n            let h = hash & 15;\r\n            let u = h < 8 ? x : y;\r\n            let v = h < 4 ? y : (h == 12 || h == 14) ? x : z;\r\n            return ((h & 1) == 0 ? u : -u) + ((h & 2) == 0 ? v : -v);\r\n        }\r\n\r\n        let A = p[X] + Y, AA = p[A] + Z, AB = p[A + 1] + Z;\r\n        let B = p[X + 1] + Y, BA = p[B] + Z, BB = p[B + 1] + Z;\r\n\r\n        return _lerp(w, _lerp(v, _lerp(u, _grad(p[AA], x, y, z),\r\n            _grad(p[BA], x - 1, y, z)),\r\n            _lerp(u, _grad(p[AB], x, y - 1, z),\r\n                _grad(p[BB], x - 1, y - 1, z))),\r\n            _lerp(v, _lerp(u, _grad(p[AA + 1], x, y, z - 1),\r\n                _grad(p[BA + 1], x - 1, y, z - 1)),\r\n                _lerp(u, _grad(p[AB + 1], x, y - 1, z - 1),\r\n                    _grad(p[BB + 1], x - 1, y - 1, z - 1)\r\n                )\r\n            )\r\n        );\r\n    }\r\n}"],"names":[],"mappings":"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"}